<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/ZephyrTemplate.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />


<!-- InstanceBeginEditable name="doctitle" -->
<title>Running SOWH</title>
<!-- InstanceEndEditable -->

<![endif]--><!--[if IE]>
<style type="text/css"> 
/* place css fixes for all versions of IE in this conditional comment */
.thrColFixHdr #sidebar2, .thrColFixHdr #sidebar1 { padding-top: 30px; }
.thrColFixHdr #mainContent { zoom: 1; }
/* the above proprietary zoom property gives IE the hasLayout it needs to avoid several bugs */
</style>
<![endif]-->

<style type="text/css">
<!--
-->
</style>
<link href="CSS/mesquitePackage.css" rel="stylesheet" type="text/css" />
<link href="SpryAssets/SpryCollapsiblePanel.css" rel="stylesheet" type="text/css" />

<script src="SpryAssets/SpryCollapsiblePanel.js" type="text/javascript"></script>
<script type="text/javascript" src="SpryAssets/SpryURLUtils.js"></script>
<script type="text/javascript" src="javascript/mesquiteZephyr.js"></script>

<!-- InstanceBeginEditable name="head" -->
<!-- InstanceEndEditable -->
</head>

<body bgcolor="#f4f0e2" class="thrColFixHdr" >

<div id="container">
  <div id="header">
    <table width="100%" border="0" cellpadding="4">
  <tr>
    <td width="51%"><img src="images/zephyrBannerNarrow.jpg" width="628" height="110" /></td>
    <td width="33%" align="right"><div id="subtitle"><!-- InstanceBeginEditable name="subtitle" --> Running SOWH<!-- InstanceEndEditable --></div></td>
    <td width="2%">&nbsp;</td>
    <td width="14%">Version 3.0<br />
      27 December 2018<br /></td>
  </tr>
</table>

</div>
  
  
<div id="sidebar1">
  
  
  
  
   <div id="NonCollapsiblePanel">
    <a href="http://zephyr.mesquiteproject.org">Zephyr Website</a>
  </div>

	<div id="NonCollapsiblePanel">
    <a href="javascript:pageLink('introduction.html')">Introduction</a>
  </div>
   <div id="NonCollapsiblePanel">
    <a href="javascript:pageLink('download.html')">Download & Installation</a>
  </div>
 <div id="OverviewPanel" class="CollapsiblePanel">
    <div class="CollapsiblePanelTab" tabindex="0">Getting Started ˇ</div>
    <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('beginning.html');">Beginning Zephyr</a></td></tr>
  			<tr><td><a href="javascript:pageLink('generalfeatures.html');">General Features</a></td></tr>
		</table>
    </div>
  </div>
  <div id="TreeInferenceProgramsPanel" class="CollapsiblePanel">
    <div class="CollapsiblePanelTab" tabindex="0">Inference Programs ˇ</div>
    <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('GARLIOverview.html');">GARLI</a></td></tr>
  			<tr><td><a href="javascript:pageLink('IQTREEOverview.html');">IQ-TREE</a></td></tr>
  			<tr><td><a href="javascript:pageLink('PAUPOverview.html');">PAUP*</a></td></tr>
  			<tr><td><a href="javascript:pageLink('RAXMLOverview.html');">RAxML</a></td></tr>
  			<tr><td><a href="javascript:pageLink('TNTOverview.html');">TNT</a></td></tr>
		</table>
    </div>
  </div>
 <div id="LocationPanel" class="CollapsiblePanel">
    <div class="CollapsiblePanelTab" tabindex="0">Analysis Location ˇ</div>
    <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('localanalyses.html');">Local Analyses</a></td></tr>
  			<tr><td><a href="javascript:pageLink('cipresanalyses.html');">CIPRes Analyses</a></td></tr>
  			<tr><td><a href="javascript:pageLink('sshanalyses.html');">SSH Server Analyses</a></td></tr>
		</table>
    </div>
  </div>

	  <div id="SOWHTestPanel" class="CollapsiblePanel">
    <div class="CollapsiblePanelTab" tabindex="0">SOWH Test ˇ</div>
    <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('SOWHintroduction.html');">Introduction</a></td></tr>
  			<tr><td><a href="javascript:pageLink('SOWHpreparing.html');">Preparing your files</a></td></tr>
  			<tr><td><a href="javascript:pageLink('SOWHrunning.html');">Running the test</a></td></tr>
		</table>
    </div>
  </div>

<div id="HelpPanel" class="CollapsiblePanel">
  <div class="CollapsiblePanelTab" tabindex="0">Help & Info ˇ</div>
  <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('gettinghelp.html');">Getting Help</a></td></tr>
  			<tr><td><a href="javascript:pageLink('releasedates.html');">Release Dates</a></td></tr>
  			<tr><td><a href="javascript:pageLink('features.html');">Feature & Bug History</a></td></tr>
  			<tr><td><a href="javascript:pageLink('future.html');">Future Directions</a></td></tr>
	</table>
  </div>
</div>

	<div id="TechnicalPanel" class="CollapsiblePanel">
  <div class="CollapsiblePanelTab" tabindex="0">Technical Details ˇ</div>
  <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('sourceCode.html');">Source Code</a></td></tr>
		</table>
  </div>
</div>



<div id="CreditPanel" class="CollapsiblePanel">
  <div class="CollapsiblePanelTab" tabindex="0">Citation & Credit ˇ</div>
  <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('citation.html');">How to Cite</a></td></tr>
  			<tr><td><a href="javascript:pageLink('acknowledgements.html');">Acknowledgements</a></td></tr>
		</table>
  </div>
</div>


<h3>&nbsp;</h3>
  <!-- end #sidebar1 --></div>

  <div id="mainContent">
    
<!-- InstanceBeginEditable name="content" -->
    
    <h1 id="toc0"><a name="Running the SOWH test"></a>Running the SOWH test</h1>
 Once you have <a class="wiki_link" href="SOWHpreparing.html">prepared your Mesquite file</a>, you can run the SOWH test.<br />
<br />
Make sure the frontmost window contains your model tree, the optimal tree you found from your constrained search.<br />
<br />
Then, choose Analysis&gt;SOWH Test... and you will be presented with a series of dialog boxes. In the first dialog box you will choose how to simulate data up the branches of the model tree:<br />
<div style="text-align: center"><img src="files/SOWH1.jpg" alt="SOWH1.jpg" title="SOWH1.jpg" style="height: 371px; width: 311px;" /></div><br />
You will generally choose Evolve DNA Characters.<br />
<br />
In the second dialog box, you will choose either &quot;Single Stored Probability Model for Simulation&quot; or &quot;Current Probability Model Set (for Simulation)&quot; depending upon whether you want to use the same probability model for all sites (the first choice), or whether you want to assign different probability models to different characters (the second choice, which can be done in the List of Characters window if you choose Columns&gt;Current Probability Models and then use the popup menu at the top of the column that appears to set the models for different characters).<br />
<div style="text-align: center"><img src="files/SOWH2.jpg" alt="SOWH2.jpg" title="SOWH2.jpg" style="height: 371px; width: 343px;" /></div><br />
In the example above, we have chosen to use a single stored model, and so Mesquite will then ask which model to use for all sites. In the <a class="wiki_link" href="Introduction%20to%20the%20SOWH%20test.html">example file about trachypachids</a>, the model that is stored in the file is called &quot;GTR + G + I&quot;, and this is the one we will choose:<br />
<br />
<div style="text-align: center"><img src="files/SOWH3.jpg" alt="SOWH3.jpg" title="SOWH3.jpg" style="height: 424px; width: 311px;" /></div><br />
Zephyr will then ask for the program that you will use to search for optimal trees. Note that you can choose from various likelihood, parsimony, and distance options. (Even though &quot;RAxML Exporter&quot; is shown in the list below, that choice will not be allowed.)<br />
<br />
<div style="text-align: center"><img src="files/SOWHChoice2.jpg" width="306" height="362" alt=""/></div>
<br />
For speed's sake, in this example we will be choosing RAxML Likelihood.<br />
<br />
The next dialog box will be let you choose the core aspects of the SOWH test:<br />
<div style="text-align: center"><img src="files/SOWHTestOptions.jpg" alt="SOWHTestOptions.jpg" title="SOWHTestOptions.jpg" style="height: 335px; width: 336px;" /></div><br />
In this dialog box, you can choose to have the observed value of the test statistic calculated, in which case Zephyr will start the test by inferring the optimal constrained tree and the optimal unconstrained tree, and taking the difference between their scores. However, for the trachypachid example, we have already done that, and come up with a value of 33.470202, and so we enter that in the &quot;pre-calculated observed value&quot; box, and choose &quot;use pre-calculated observed value&quot;.<br />
<br />
In the above dialog box you can select how many simulated matrices to examine (we chose only 4, which is too few - we should do at least 100). We have also chosen to alter the data between the simulation and tree inference phases, so that we can force the simulated matrix to have same pattern of gaps as that in the observed matrix. We will choose a data alterer later. That will be shown below, but before we get to that, there are the remaining items in the bottom of our main SOWH Test Options dialog box.<br />
<br />
The remaining items are specific to each tree-inference program, and usually contain some details about the sorts of constraint trees offered by the program. For RAxML, there is an additional option: &quot;use final gamma-based optimized RAxML score&quot;. This tells Zephyr to use not the score of the best tree as originally calculated, but as calculated in the secondary pass that RAxML in which it performs a more accurate calculation of the likelihood of the tree (although it unfortunately only does this using a GTR+G model, even if the search was done using a GTR+I+G model).<br />
<br />
Once you press OK on the SOWH Test Options dialog box, you will then be asked to choose a name and location for the SOWH report file that will be generated.<br />
<br />
Now, back to our choice to alter data between simulating the data and inferring the tree. Although we could chose many options, the one we decided to do is duplicate the pattern of gaps, such that ever cell in the observed matrix that has a gap will also have a gap in the simulated matrix, and so we choose the data alterer &quot;Impose Indel Pattern of Other Matrix&quot;:<br />
<br />
<div style="text-align: center"><img src="files/SOWH6.jpg" alt="SOWH6.jpg" title="SOWH6.jpg" style="height: 422px; width: 315px;" /></div>Zephyr will now present you with the standard dialog boxes for GARLI, RAxML, or PAUP, and allow you to choose the details of the search strategy for finding the optimal tree. Once you have made those choices, it will then ask you about the tree to be used as the constraint tree:<br />
<br />
<div style="text-align: center"><img src="files/SOWHConstraintQueryFull.png" alt="SOWHConstraintQueryFull.png" title="SOWHConstraintQueryFull.png" style="height: 620px; width: 800px;" /></div><br />
<br />
In this case, the tree shown in the window is <em><strong>not</strong></em> the tree to be used as a constraint tree (as that is the model tree, not the constraint tree). In general, you will answer No to this alert so that you can choose the correct tree window containing the constraint tree. For the trachypachid example, that tree window is labelled as &quot;Constraint tree&quot;, and so we would choose that:<br />
<br />
<div style="text-align: center"><img src="files/SOWHChooseConstraint2.jpg" alt="SOWHChooseConstraint2.jpg" title="SOWHChooseConstraint2.jpg" style="height: 327px; width: 487px;" /></div><br />
Once you make that choice, the SOWH test will begin. Mesquite will simulate however many matrices you requested, and for each ask the external program to find the optimal constrained tree, and the optimal unconstrained tree, and take the difference between their scores. This is the test statistic, delta. Zephyr will compare the values of that test statistic across simulated matrices to the observed value, and see what fraction of the simulated delta values are greater than or equal to the observed value of delta, and this will be an estimate of the p-value. It will report the p-value as the test proceeds in a window on the right. Once it has done the replicates you requested, it will ask you if you want to do any more. Once you have decided you have done enough (again, the 4 done in the example is not enough!), then the final results will be displayed to the right of the model tree:<br />
<br />
<div style="text-align: center"><img src="files/SOWHCompleted.jpg" alt="SOWHCompleted.jpg" title="SOWHCompleted.jpg" style="height: 620px; width: 800px;" /></div><br />
<br />
In addition, the SOWH test report will contain all of the details of the analysis. Here is the small test report from the trachypachid example:<br />
<br />
<div style="text-align: center"><img src="files/SOWHReport.png" alt="SOWHReport.png" title="SOWHReport.png" style="height: 553px; width: 640px;" /></div>

<!-- InstanceEndEditable -->

    
    
    </div>
	<!-- This clearing element should immediately follow the #mainContent div in order to force the #container div to contain all child floats --><br class="clearfloat" />
  <div id="footer">
    <p> ©2018 David R. Maddison &amp; Wayne P. Maddison</p>
  <!-- end #footer --></div>
<!-- end #container --></div>

<script type="text/javascript">
<!--


var OverviewPanel = null;
var TreeInferenceProgramsPanel = null;
var SOWHTestPanel = null;
var HelpPanel = null;
var TechnicalPanel = null;
var CreditPanel = null;

if (qsParm['OverviewPanel']=='open')
 	OverviewPanel = new Spry.Widget.CollapsiblePanel("OverviewPanel", {contentIsOpen: true});
else
 	OverviewPanel = new Spry.Widget.CollapsiblePanel("OverviewPanel", {contentIsOpen: false});
	
if (qsParm['TreeInferenceProgramsPanel']=='open')
 	TreeInferenceProgramsPanel = new Spry.Widget.CollapsiblePanel("TreeInferenceProgramsPanel", {contentIsOpen: true});
else
 	TreeInferenceProgramsPanel = new Spry.Widget.CollapsiblePanel("TreeInferenceProgramsPanel", {contentIsOpen: false});
	
if (qsParm['LocationPanel']=='open')
 	LocationPanel = new Spry.Widget.CollapsiblePanel("LocationPanel", {contentIsOpen: true});
else
 	LocationPanel = new Spry.Widget.CollapsiblePanel("LocationPanel", {contentIsOpen: false});
	

if (qsParm['SOWHTestPanel']=='open')
 	SOWHTestPanel = new Spry.Widget.CollapsiblePanel("SOWHTestPanel", {contentIsOpen: true});
else
 	SOWHTestPanel = new Spry.Widget.CollapsiblePanel("SOWHTestPanel", {contentIsOpen: false});
	

if (qsParm['CreditPanel']=='open')
 	CreditPanel = new Spry.Widget.CollapsiblePanel("CreditPanel", {contentIsOpen: true});
else
 	CreditPanel = new Spry.Widget.CollapsiblePanel("CreditPanel", {contentIsOpen: false});

if (qsParm['HelpPanel']=='open')
 	HelpPanel = new Spry.Widget.CollapsiblePanel("HelpPanel", {contentIsOpen: true});
else
 	HelpPanel = new Spry.Widget.CollapsiblePanel("HelpPanel", {contentIsOpen: false});

if (qsParm['TechnicalPanel']=='open')
 	TechnicalPanel = new Spry.Widget.CollapsiblePanel("TechnicalPanel", {contentIsOpen: true});
else
 	TechnicalPanel = new Spry.Widget.CollapsiblePanel("TechnicalPanel", {contentIsOpen: false});



//-->
</script>
</body>
<!-- InstanceEnd --></html>
